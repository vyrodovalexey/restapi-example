{
  "functional_tests": {
    "rest_api": {
      "test_cases": [
        {
          "id": "FT-REST-001",
          "name": "List items - empty store",
          "description": "GET /api/v1/items returns 200 with empty array when store is empty",
          "method": "GET",
          "endpoint": "/api/v1/items",
          "expected_status": 200,
          "expected_response": {
            "success": true,
            "data": []
          }
        },
        {
          "id": "FT-REST-002",
          "name": "Create item - valid",
          "description": "POST /api/v1/items with valid data returns 201 with created item",
          "method": "POST",
          "endpoint": "/api/v1/items",
          "request_body": {
            "name": "Test Item",
            "description": "A test item",
            "price": 19.99
          },
          "expected_status": 201,
          "expected_response": {
            "success": true
          }
        },
        {
          "id": "FT-REST-003",
          "name": "Create item - missing name",
          "description": "POST /api/v1/items with missing name returns 400 validation error",
          "method": "POST",
          "endpoint": "/api/v1/items",
          "request_body": {
            "description": "A test item",
            "price": 19.99
          },
          "expected_status": 400,
          "expected_error": "name cannot be empty"
        },
        {
          "id": "FT-REST-004",
          "name": "Create item - negative price",
          "description": "POST /api/v1/items with negative price returns 400 validation error",
          "method": "POST",
          "endpoint": "/api/v1/items",
          "request_body": {
            "name": "Test Item",
            "price": -10.00
          },
          "expected_status": 400,
          "expected_error": "price cannot be negative"
        },
        {
          "id": "FT-REST-005",
          "name": "Create item - invalid JSON",
          "description": "POST /api/v1/items with invalid JSON returns 400",
          "method": "POST",
          "endpoint": "/api/v1/items",
          "request_body_raw": "invalid json",
          "expected_status": 400,
          "expected_error": "invalid request body"
        },
        {
          "id": "FT-REST-006",
          "name": "Get item - exists",
          "description": "GET /api/v1/items/{id} returns 200 with item when it exists",
          "method": "GET",
          "endpoint": "/api/v1/items/{id}",
          "expected_status": 200,
          "expected_response": {
            "success": true
          }
        },
        {
          "id": "FT-REST-007",
          "name": "Get item - not found",
          "description": "GET /api/v1/items/{id} returns 404 when item does not exist",
          "method": "GET",
          "endpoint": "/api/v1/items/non-existent-id",
          "expected_status": 404,
          "expected_error": "item not found"
        },
        {
          "id": "FT-REST-008",
          "name": "Update item - exists",
          "description": "PUT /api/v1/items/{id} returns 200 with updated item",
          "method": "PUT",
          "endpoint": "/api/v1/items/{id}",
          "request_body": {
            "name": "Updated Item",
            "description": "Updated description",
            "price": 29.99
          },
          "expected_status": 200,
          "expected_response": {
            "success": true
          }
        },
        {
          "id": "FT-REST-009",
          "name": "Update item - not found",
          "description": "PUT /api/v1/items/{id} returns 404 when item does not exist",
          "method": "PUT",
          "endpoint": "/api/v1/items/non-existent-id",
          "request_body": {
            "name": "Updated Item",
            "price": 29.99
          },
          "expected_status": 404,
          "expected_error": "item not found"
        },
        {
          "id": "FT-REST-010",
          "name": "List items - with data",
          "description": "GET /api/v1/items returns 200 with array containing items",
          "method": "GET",
          "endpoint": "/api/v1/items",
          "expected_status": 200,
          "expected_response": {
            "success": true
          },
          "expected_min_items": 1
        },
        {
          "id": "FT-REST-011",
          "name": "Delete item - exists",
          "description": "DELETE /api/v1/items/{id} returns 204 when item exists",
          "method": "DELETE",
          "endpoint": "/api/v1/items/{id}",
          "expected_status": 204
        },
        {
          "id": "FT-REST-012",
          "name": "Delete item - not found",
          "description": "DELETE /api/v1/items/{id} returns 404 when item does not exist",
          "method": "DELETE",
          "endpoint": "/api/v1/items/non-existent-id",
          "expected_status": 404,
          "expected_error": "item not found"
        },
        {
          "id": "FT-REST-013",
          "name": "Health check",
          "description": "GET /health returns 200 with healthy status",
          "method": "GET",
          "endpoint": "/health",
          "expected_status": 200,
          "expected_response": {
            "success": true,
            "data": {
              "status": "healthy"
            }
          }
        },
        {
          "id": "FT-REST-014",
          "name": "Readiness check",
          "description": "GET /ready returns 200 with ready status",
          "method": "GET",
          "endpoint": "/ready",
          "expected_status": 200,
          "expected_response": {
            "success": true,
            "data": {
              "status": "ready"
            }
          }
        },
        {
          "id": "FT-REST-015",
          "name": "CRUD workflow - complete lifecycle",
          "description": "Complete CRUD lifecycle: create, read, update, delete",
          "workflow": [
            {"action": "create", "method": "POST", "endpoint": "/api/v1/items"},
            {"action": "read", "method": "GET", "endpoint": "/api/v1/items/{id}"},
            {"action": "update", "method": "PUT", "endpoint": "/api/v1/items/{id}"},
            {"action": "verify_update", "method": "GET", "endpoint": "/api/v1/items/{id}"},
            {"action": "delete", "method": "DELETE", "endpoint": "/api/v1/items/{id}"},
            {"action": "verify_delete", "method": "GET", "endpoint": "/api/v1/items/{id}"}
          ]
        },
        {
          "id": "FT-REST-016",
          "name": "Concurrent creates",
          "description": "10 concurrent POST requests should all succeed",
          "concurrent_requests": 10,
          "method": "POST",
          "endpoint": "/api/v1/items",
          "expected_status": 201
        },
        {
          "id": "FT-REST-017",
          "name": "Request with X-Request-ID header",
          "description": "Request with X-Request-ID header should return same ID in response",
          "method": "GET",
          "endpoint": "/health",
          "headers": {
            "X-Request-ID": "test-request-id-12345"
          },
          "expected_status": 200,
          "expected_headers": {
            "X-Request-ID": "test-request-id-12345"
          }
        }
      ],
      "auth_test_cases": [
        {
          "id": "FT-AUTH-001",
          "name": "Public endpoints accessible without auth",
          "description": "Health and ready endpoints are accessible without authentication even when auth is enabled",
          "function": "TestAuthPublicEndpoints",
          "auth_mode": "apikey",
          "expected_status": 200
        },
        {
          "id": "FT-AUTH-002",
          "name": "Protected endpoints require auth",
          "description": "Protected API endpoints return 401 when no credentials are provided",
          "function": "TestAuthProtectedEndpointsRequireAuth",
          "auth_mode": "apikey",
          "expected_status": 401
        },
        {
          "id": "FT-AUTH-003",
          "name": "API key access",
          "description": "Protected endpoints are accessible with a valid API key in X-API-Key header",
          "function": "TestAuthAPIKeyAccess",
          "auth_mode": "apikey",
          "expected_status": 200
        },
        {
          "id": "FT-AUTH-004",
          "name": "Basic auth access",
          "description": "Protected endpoints are accessible with valid basic auth credentials",
          "function": "TestAuthBasicAccess",
          "auth_mode": "basic",
          "expected_status": 200
        },
        {
          "id": "FT-AUTH-005",
          "name": "Invalid API key",
          "description": "Invalid API key returns 401 Unauthorized",
          "function": "TestAuthInvalidAPIKey",
          "auth_mode": "apikey",
          "expected_status": 401
        },
        {
          "id": "FT-AUTH-006",
          "name": "Invalid basic auth",
          "description": "Wrong password or unknown user returns 401 Unauthorized",
          "function": "TestAuthInvalidBasicAuth",
          "auth_mode": "basic",
          "expected_status": 401
        },
        {
          "id": "FT-AUTH-007",
          "name": "CRUD with API key auth",
          "description": "Full CRUD lifecycle with API key authentication succeeds",
          "function": "TestAuthCRUDWithAPIKey",
          "auth_mode": "apikey",
          "workflow": ["create", "read", "update", "list", "delete", "verify_delete"]
        },
        {
          "id": "FT-AUTH-008",
          "name": "Multi-auth with API key",
          "description": "Multi-auth mode accepts API key authentication",
          "function": "TestAuthMultiAuthWithAPIKey",
          "auth_mode": "multi",
          "auth_methods": ["apikey", "basic"],
          "expected_status": 200
        },
        {
          "id": "FT-AUTH-009",
          "name": "Multi-auth with basic auth",
          "description": "Multi-auth mode accepts basic auth credentials",
          "function": "TestAuthMultiAuthWithBasicAuth",
          "auth_mode": "multi",
          "auth_methods": ["apikey", "basic"],
          "expected_status": 200
        },
        {
          "id": "FT-AUTH-010",
          "name": "OIDC auth with valid token",
          "description": "OIDC auth accepts a valid Bearer token and returns 200",
          "function": "TestAuthOIDCWithValidToken",
          "auth_mode": "oidc",
          "expected_status": 200
        },
        {
          "id": "FT-AUTH-011",
          "name": "OIDC auth with invalid token",
          "description": "OIDC auth rejects an invalid Bearer token and returns 401",
          "function": "TestAuthOIDCWithInvalidToken",
          "auth_mode": "oidc",
          "expected_status": 401
        },
        {
          "id": "FT-AUTH-012",
          "name": "OIDC auth with expired token",
          "description": "OIDC auth rejects an expired Bearer token and returns 401",
          "function": "TestAuthOIDCWithExpiredToken",
          "auth_mode": "oidc",
          "expected_status": 401
        },
        {
          "id": "FT-AUTH-013",
          "name": "Multi-auth CRUD workflow",
          "description": "Full CRUD lifecycle using multi-auth mode with API key succeeds",
          "function": "TestAuthMultiAuthCRUDWorkflow",
          "auth_mode": "multi",
          "auth_methods": ["apikey", "basic"],
          "workflow": ["create", "read", "update", "verify_update", "delete", "verify_delete"]
        }
      ]
    },
    "websocket": {
      "test_cases": [
        {
          "id": "FT-WS-001",
          "name": "Connect to WebSocket",
          "description": "WebSocket connection should be established successfully",
          "endpoint": "/ws",
          "expected": "connection_established"
        },
        {
          "id": "FT-WS-002",
          "name": "Receive random value",
          "description": "Client should receive a message with valid format",
          "endpoint": "/ws",
          "expected_message_format": {
            "type": "random_value",
            "value": "integer",
            "timestamp": "RFC3339"
          }
        },
        {
          "id": "FT-WS-003",
          "name": "Receive multiple values",
          "description": "Client should receive 5 messages within 7 seconds",
          "endpoint": "/ws",
          "expected_messages": 5,
          "timeout_seconds": 7
        },
        {
          "id": "FT-WS-004",
          "name": "Values are random",
          "description": "Received values should not all be the same",
          "endpoint": "/ws",
          "messages_to_collect": 5,
          "expected": "values_vary"
        },
        {
          "id": "FT-WS-005",
          "name": "Message interval ~1 second",
          "description": "Messages should arrive approximately every 1 second (900-1100ms)",
          "endpoint": "/ws",
          "expected_interval_ms": {
            "min": 900,
            "max": 1100
          }
        },
        {
          "id": "FT-WS-006",
          "name": "Multiple concurrent clients",
          "description": "5 concurrent clients should all receive messages",
          "endpoint": "/ws",
          "concurrent_clients": 5,
          "expected": "all_receive_messages"
        },
        {
          "id": "FT-WS-007",
          "name": "Client disconnect handling",
          "description": "Server should handle client disconnect gracefully",
          "endpoint": "/ws",
          "action": "connect_then_disconnect",
          "expected": "graceful_handling"
        },
        {
          "id": "FT-WS-008",
          "name": "Reconnection after disconnect",
          "description": "Client should be able to reconnect after disconnecting",
          "endpoint": "/ws",
          "action": "connect_disconnect_reconnect",
          "expected": "reconnection_successful"
        }
      ]
    }
  },
  "integration_tests": {
    "test_cases": [
      {
        "id": "IT-001",
        "name": "Health endpoint accessible",
        "description": "GET /health returns 200 with healthy status against running server",
        "build_tag": "integration",
        "function": "TestIntegration_HealthEndpointAccessible"
      },
      {
        "id": "IT-002",
        "name": "Ready endpoint accessible",
        "description": "GET /ready returns 200 with ready status against running server",
        "build_tag": "integration",
        "function": "TestIntegration_ReadyEndpointAccessible"
      },
      {
        "id": "IT-003",
        "name": "Metrics endpoint accessible",
        "description": "GET /metrics returns 200 with Prometheus metrics",
        "build_tag": "integration",
        "function": "TestIntegration_MetricsEndpointAccessible"
      },
      {
        "id": "IT-004",
        "name": "CRUD operations",
        "description": "Full create, read, update, delete lifecycle against running server",
        "build_tag": "integration",
        "function": "TestIntegration_CRUDOperations"
      },
      {
        "id": "IT-005",
        "name": "API key authentication",
        "description": "Valid/invalid API key authentication against running server",
        "build_tag": "integration",
        "function": "TestIntegration_APIKeyAuthentication",
        "skip_condition": "INTEGRATION_API_KEY not set"
      },
      {
        "id": "IT-006",
        "name": "Basic authentication",
        "description": "Valid/invalid basic auth against running server",
        "build_tag": "integration",
        "function": "TestIntegration_BasicAuthentication",
        "skip_condition": "INTEGRATION_BASIC_USER/PASS not set"
      },
      {
        "id": "IT-007",
        "name": "Unauthorized access",
        "description": "Protected endpoints return 401 without credentials",
        "build_tag": "integration",
        "function": "TestIntegration_UnauthorizedAccess",
        "skip_condition": "No auth configured"
      },
      {
        "id": "IT-008",
        "name": "mTLS authentication",
        "description": "Mutual TLS client certificate authentication",
        "build_tag": "integration",
        "function": "TestIntegration_MTLSAuthentication",
        "skip_condition": "mTLS cert paths not set"
      },
      {
        "id": "IT-009",
        "name": "OIDC authentication",
        "description": "OIDC/JWT bearer token authentication via Keycloak",
        "build_tag": "integration",
        "function": "TestIntegration_OIDCAuthentication",
        "skip_condition": "Keycloak or OIDC config not available"
      },
      {
        "id": "IT-010",
        "name": "Multi-auth integration test",
        "description": "Multi-auth mode with API key and basic auth against running server",
        "build_tag": "integration",
        "function": "TestIntegration_MultiAuthAuthentication",
        "skip_condition": "INTEGRATION_API_KEY and INTEGRATION_BASIC_USER/PASS not set"
      },
      {
        "id": "IT-011",
        "name": "mTLS with Vault PKI certificates",
        "description": "Mutual TLS authentication using certificates issued by Vault PKI",
        "build_tag": "integration",
        "function": "TestIntegration_MTLSWithVaultPKI",
        "skip_condition": "Vault PKI and mTLS cert paths not set"
      }
    ]
  },
  "e2e_tests": {
    "test_cases": [
      {
        "id": "E2E-001",
        "name": "Full CRUD workflow",
        "description": "Complete create → read → update → verify → delete → verify journey",
        "build_tag": "e2e",
        "function": "TestE2E_FullCRUDWorkflow"
      },
      {
        "id": "E2E-002",
        "name": "API key workflow",
        "description": "Authenticate with API key → CRUD operations → cleanup",
        "build_tag": "e2e",
        "function": "TestE2E_APIKeyWorkflow",
        "skip_condition": "INTEGRATION_API_KEY not set"
      },
      {
        "id": "E2E-003",
        "name": "Basic auth workflow",
        "description": "Authenticate with basic auth → CRUD operations → cleanup",
        "build_tag": "e2e",
        "function": "TestE2E_BasicAuthWorkflow",
        "skip_condition": "INTEGRATION_BASIC_USER/PASS not set"
      },
      {
        "id": "E2E-004",
        "name": "Public endpoints always accessible",
        "description": "Health, ready, metrics endpoints work without auth",
        "build_tag": "e2e",
        "function": "TestE2E_PublicEndpointsAlwaysAccessible"
      },
      {
        "id": "E2E-005",
        "name": "Unauthorized access denied",
        "description": "All protected endpoints return 401 without credentials",
        "build_tag": "e2e",
        "function": "TestE2E_UnauthorizedAccessDenied",
        "skip_condition": "No auth configured"
      },
      {
        "id": "E2E-006",
        "name": "Concurrent requests",
        "description": "10 concurrent authenticated requests all succeed",
        "build_tag": "e2e",
        "function": "TestE2E_ConcurrentRequests"
      },
      {
        "id": "E2E-007",
        "name": "Graceful degradation",
        "description": "Server handles invalid auth gracefully without crashing",
        "build_tag": "e2e",
        "function": "TestE2E_GracefulDegradation"
      },
      {
        "id": "E2E-008",
        "name": "mTLS workflow",
        "description": "Authenticate with mTLS client certificate → CRUD operations → cleanup",
        "build_tag": "e2e",
        "function": "TestE2E_MTLSWorkflow",
        "skip_condition": "mTLS cert paths not set"
      },
      {
        "id": "E2E-009",
        "name": "OIDC workflow with Keycloak",
        "description": "Obtain OIDC token from Keycloak → authenticate → CRUD operations → cleanup",
        "build_tag": "e2e",
        "function": "TestE2E_OIDCWorkflowWithKeycloak",
        "skip_condition": "Keycloak or OIDC config not available"
      }
    ]
  },
  "performance_tests": {
    "test_cases": [
      {
        "id": "PERF-001",
        "name": "Health endpoint baseline",
        "description": "Baseline latency measurement for GET /health",
        "build_tag": "performance",
        "function": "BenchmarkHealthEndpoint"
      },
      {
        "id": "PERF-002",
        "name": "API key auth overhead",
        "description": "Latency overhead of API key authentication",
        "build_tag": "performance",
        "function": "BenchmarkAPIKeyAuth",
        "skip_condition": "INTEGRATION_API_KEY not set"
      },
      {
        "id": "PERF-003",
        "name": "Basic auth overhead",
        "description": "Latency overhead of bcrypt-based basic authentication",
        "build_tag": "performance",
        "function": "BenchmarkBasicAuth",
        "skip_condition": "INTEGRATION_BASIC_USER/PASS not set"
      },
      {
        "id": "PERF-004",
        "name": "CRUD create latency",
        "description": "Latency measurement for POST /api/v1/items",
        "build_tag": "performance",
        "function": "BenchmarkCRUDCreate"
      },
      {
        "id": "PERF-005",
        "name": "CRUD read latency",
        "description": "Latency measurement for GET /api/v1/items/{id}",
        "build_tag": "performance",
        "function": "BenchmarkCRUDRead"
      },
      {
        "id": "PERF-006",
        "name": "Concurrent requests throughput",
        "description": "Throughput under varying concurrency levels (1, 5, 10, 25)",
        "build_tag": "performance",
        "function": "BenchmarkConcurrentRequests"
      },
      {
        "id": "PERF-007",
        "name": "OIDC auth overhead",
        "description": "Latency overhead of OIDC/JWT bearer token authentication",
        "build_tag": "performance",
        "function": "BenchmarkOIDCAuth",
        "skip_condition": "Keycloak or OIDC config not available"
      },
      {
        "id": "PERF-008",
        "name": "Multi-auth overhead",
        "description": "Latency overhead of multi-method authentication (API key + basic)",
        "build_tag": "performance",
        "function": "BenchmarkMultiAuth",
        "skip_condition": "Multi-auth config not available"
      }
    ]
  },
  "test_data": {
    "valid_items": [
      {
        "name": "Test Item 1",
        "description": "First test item",
        "price": 19.99
      },
      {
        "name": "Test Item 2",
        "description": "Second test item",
        "price": 29.99
      },
      {
        "name": "Test Item 3",
        "description": "Third test item",
        "price": 39.99
      }
    ],
    "invalid_items": [
      {
        "name": "",
        "price": 10.00,
        "expected_error": "name cannot be empty"
      },
      {
        "name": "Test",
        "price": -10.00,
        "expected_error": "price cannot be negative"
      }
    ]
  }
}
